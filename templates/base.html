{% load static %}
<!-- Template variables for URLs of different views for easier reference in navigation menus-->
{% url 'home' as home_url %}
{% url 'nursery' as nursery_url %}
{% url 'about' as about_url %}
{% url 'account_signup' as signup_url %}
{% url 'account_login' as login_url %}
{% url 'account_logout' as logout_url %}
{% url 'mygarden' as garden_url %}

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description"
    content="Welcome to Fableseed, a collaborative storytelling platform where stories grow like plants and words breathe life into a blooming world.">
  <meta name="author" content="Lucy Sears">
  <meta name="keywords" content="storytelling, stories, collaborative, apocalypse, garden, flowers, ">
  <title>{% block title %}
    Fableseed
    {% endblock %}</title>
  <!-- Tailwind output CSS file and custom overrides -->
  <link href="{% static 'css/main.css' %}" rel="stylesheet">
  <link href="{% static 'css/custom.css' %}" rel="stylesheet">
  <!-- Font awesome kit -->
  <script src="https://kit.fontawesome.com/0b96933893.js" crossorigin="anonymous"></script>
</head>

<!-- Apply different background colours based on current page -->
<body
  class="min-h-screen min-w-full max-w-full flex flex-col {% if request.path == home_url or request.path == about_url %}bg-base-300 {% else%}bg-primary{% endif %} 
  md:bg-[url(/static/images/bg1.avif)] bg-contain lg:bg-cover">
  <header class="w-full">
    <div class="navbar bg-base-200 shadow border-b border-base-100">
      <div class="navbar-start flex-3 md:flex-2 lg:flex-1 gap-2 md:gap-3">
        <!-- Mobile menu button -->
        <div class="dropdown pr-0">
          <button tabindex="0" class="btn btn-ghost lg:hidden" aria-label="Open menu">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16" />
            </svg>
          </button>
          <!-- Nav list and links. List items apply an active class when current page matches the link -->
          <ul tabindex="0" class="menu menu-lg dropdown-content bg-base-200 rounded-box z-1 mt-3 w-52 p-2 shadow">
            <li class="{% if request.path == home_url %} active" aria-current="page{% endif %}"><a
                href="{% url 'home' %}">Home</a></li>
            <li class="{% if request.path == about_url %} active" aria-current="page{% endif %}"><a href="{% url 'about' %}">About</a>
            </li>
            <li class="{% if request.path == nursery_url %} active" aria-current="page{% endif %}"><a
                href="{% url 'nursery' %}">Nursery</a></li>
            {% if user.is_authenticated %}
            <li class="{% if request.path == garden_url %} active" aria-current="page{% endif %}"><a
                href="{% url 'mygarden' id=user.id %}">My Garden</a></li>
            <li class="{% if request.path == logout_url %} active" aria-current="page{% endif %}"><a
                href="{% url 'account_logout' %}">Logout</a></li>
            {% else %}
            <li class="{% if request.path == signup_url %} active" aria-current="page{% endif %}"><a
                href="{% url 'account_signup' %}">Sign Up</a></li>
            <li class="{% if request.path == login_url %} active" aria-current="page{% endif %}"><a
                href="{% url 'account_login' %}">Login</a></li>
            {% endif %}
          </ul>
        </div>

        <div class="flex items-center gap-3 justify-center" id="logo-container">
          <!-- Logo image: uses responsive AVIF sources with fallback image -->
          <picture class="order-2 lg:order-1">
            <!-- Mobile: AVIF -->
            <source media="(max-width: 767px)" type="image/avif"
              srcset="https://res.cloudinary.com/dppks2exv/image/upload/c_fit,w_160,dpr_auto/v1756564983/fableseed_logo2_1_slbqoc.avif">
            <!-- Desktop: AVIF -->
            <source media="(min-width: 768px)" type="image/avif"
              srcset="https://res.cloudinary.com/dppks2exv/image/upload/c_fit,w_200,dpr_auto/v1756564983/fableseed_logo2_1_slbqoc.avif">
            <!-- Fallback <img> static file in case Cloudinary fails -->
            <img src="../static/images/logo_75x75.avif" alt="Fableseed logo" class="w-20 h-auto" width="120" height="93"
              decoding="async">
          </picture>
          <!-- Logo text acts as main site header on all pages - links to the home page -->
          <h1 class="mt-3 lg:order-1"><a
              class="font-bold text-5xl md:text-6xl lg:text-5xl xl:text-6xl font-great-vibes hover:text-base-100"
              href="{% url 'home' %}">Fableseed</a></h1>
        </div>
      </div>
<!-- Horizontal nav-links are hidden on mobile and tablet screen, appear at larger breakpoints -->
      <div class="navbar-center flex-1 justify-center hidden lg:flex-2 lg:flex">
        <ul class="menu menu-horizontal gap-4 xl:gap-6">
          <li><a class="btn lg:btn-sm xl:btn-md bg-primary hover:bg-base-100 {% if request.path == home_url %} active"
              aria-current="page{% endif %}" href="{% url 'home' %}">Home</a></li>
          <li><a class="btn lg:btn-sm xl:btn-md bg-primary hover:bg-base-100 {% if request.path == about_url %}active"
              aria-current="page{% endif %}"  href="{% url 'about' %}">About</a></li>
          <li><a class="btn lg:btn-sm xl:btn-md bg-primary hover:bg-base-100 {% if request.path == nursery_url %}active"
              aria-current="page{% endif %}" href="{% url 'nursery' %}">Nursery</a></li>
          {% if user.is_authenticated %}
          <li><a class="btn lg:btn-sm xl:btn-md bg-primary hover:bg-base-100 {% if request.path == garden_url %}active"
              aria-current="page{% endif %}" href="{% url 'mygarden' id=user.id %}">My Garden</a></li>
          <li><a class="btn lg:btn-sm xl:btn-md bg-primary hover:bg-base-100 {% if request.path == logout_url %}active"
              aria-current="page{% endif %}" href="{% url 'account_logout' %}">Logout</a></li>
          {% else %}
          <li><a class="btn lg:btn-sm xl:btn-md bg-primary hover:bg-base-100 {% if request.path == signup_url %}active"
              aria-current="page {% endif %}" href="{% url 'account_signup' %}">Sign Up</a></li>
          <li><a class="btn lg:btn-sm xl:btn-md bg-primary hover:bg-base-100 {% if request.path == login_url %}active"
              aria-current="page{% endif %}" href="{% url 'account_login' %}">Login</a></li>
          {% endif %}
        </ul>
      </div>
      <!-- End block of the navbar shows logged in information. Hidden on mobile screens. -->
      <div class="navbar-end flex-1 justify-end hidden md:flex pr-3 md:text-xs lg:text-md xl:text-lg">
        {% if user.is_authenticated %}
        <p>You are currently logged in as {{user.get_display_name}} </p>
        {% else %}
        <p>You are currently logged out</p>
        {% endif %}
      </div>
    </div>
  </header>
  <!-- Main container for all page content to keep styling consistent. Applies mx-auto to the home-page so it looks nice on bigger screens.  -->
  <main
    class="container mx-auto mt-4 flex-grow px-4 flex flex-col {% if request.path == home_url %}justify-center{% endif %}">
    <!-- Display Django messages (ERROR/SUCCESS) with ARIA for accessibility) -->
    {% if messages %}
    {% for message in messages %}
    <div class="text-center">
      <div class="
      {% if 'success' in message.tags %}alert-success{% endif %}
      {% if 'error' in message.tags %}alert-error{% endif %}
      message alert max-sm:alert-vertical text-xs font-bold inline-block mx-auto mb-3
      " data-message="{{ message }}" role="alert" aria-live="assertive" aria-atomic="true">
        {{ message }}
      </div>
    </div>
    {% endfor %}
    {% endif %}
<!-- Page-specific content to be inserted here -->
    {% block content %}
    {% endblock %}
  </main>
  <!-- Footer shows login status -->
  <footer class="bg-base-200 mt-4 py-4 border-t border-base-100"> {% if user.is_authenticated %}
    <p class="text-center text-sm md:text-md">You are currently logged in as {{user.get_display_name}} </p>
    {% else %}
    <p class="p-2 text-center">You are currently logged out </p>
    {% endif %}
  </footer>
  <!-- Extra JavaScript block for page-specific JS -->
  {% block extra_js %}
  {% endblock %}
  <!-- Custom JS scripts for interactivity -->
  <script src="{% static 'js/script.js' %}"></script>
</body>

</html>